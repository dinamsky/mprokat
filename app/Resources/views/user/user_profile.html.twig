{% extends 'user/user_base.html.twig' %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/image_upload_preview.js') }}"></script>
    <script src="{{ asset('assets/js/jquery.maskedinput.js') }}"></script>
    <script src="{{ asset('assets/js/phone_validate.js') }}"></script>
    <script src="{{ asset('assets/js/common.js') }}"></script>
{% endblock %}

{% block content %}
    <h1>{{ app.session.get('logged_user').whois == 'new_renter' ? 'Заполните профиль!' : 'Мой профиль' }}</h1>

    {% if user.isNew == 0 %}
        <form action="/user_go_new" method="POST" class="uk-margin-large-bottom padding20 bg_white bordered">
            <div class="uk-margin-bottom">
                Мультипрокат предлагает вам перейти на новую систему заказов,<br>
                а также получить  PRO аккаунт - Бесплатно!<br>
                PRO аккаунт подтверждает вашу деятельность и дает больше клиентов.<br><br>

                PRO аккаунт действует бессрочно и дает больше возможностей, в том числе: размещать больше объявлений и получать больше звонков от клиентов
            </div>

            <div class="uk-margin-bottom"><label>Я ознакомлен и согласен с условиями <a target="_blanc" class="underline" uk-tooltip="title:откроется в новом окне" href="/assets/docs/oferta.pdf">оферты</a> <input type="checkbox" name="oferta_check" checked> </label></div>
            <div class="uk-margin-bottom"><label>Активировать бесплатно PRO аккаунт <input type="checkbox" name="pro_check" checked> </label></div>
            <input type="hidden" name="id" value="{{ user.id }}">
            <button class="uk-button uk-button-primary" >Перейти</button>
        </form>
    {% endif %}


    <div class="" style="margin-bottom: 300px">
        <div uk-grid>
            <div class="uk-width-2-3@s">
                <div style="background: white;padding: 20px;margin-bottom: 30px">
                    <span style="color:red;font-weight: bold">Пожалуйста</span> заполните свой профиль, чтобы иметь возможность оформлять заявки и участвовать в переписке.<br>
                    <b>Email</b> обязателен для повторного входа в личный кабинет.<br>
                    <b>Мобильный (!!!) телефон</b> - чтобы получать СМС от владельца/арендатора транспорта по заявке.
                </div>
                <form id="save_profile" action="/profile/save" method="POST">
                    <div>{% trans %}Имя{% endtrans %}: <input name="header" value="{{ user.header }}" class="uk-input"></div>

                    {% set phone = '' %}
                    {% set website = '' %}
                    {% set foto = '' %}
                    {% set about = '' %}

                    {% set vk = '' %}
                    {% set fb = '' %}
                    {% set ig = '' %}
                    {% set ok = '' %}
                    {% set tw = '' %}
                    {% set gp = '' %}
                    {% set yt = '' %}

                    {% for info in user.information %}
                        {% if info.uiKey == 'phone' %}
                            {% set phone = info.uiValue %}
                        {% endif %}
                        {% if info.uiKey == 'website' %}
                            {% set website = info.uiValue %}
                        {% endif %}
                        {% if info.uiKey == 'foto' %}
                            {% set foto = info.uiValue %}
                        {% endif %}
                        {% if info.uiKey == 'about' %}
                            {% set about = info.uiValue %}
                        {% endif %}

                        {% if info.uiKey == 'vk' %}{%  set vk = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'fb' %}{%  set fb = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'ig' %}{%  set ig = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'ok' %}{%  set ok = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'tw' %}{%  set tw = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'gp' %}{%  set gp = info.uiValue %}{% endif %}
                        {% if info.uiKey == 'yt' %}{%  set yt = info.uiValue %}{% endif %}

                    {% endfor %}

                    <div>Email: <input name="email" value="{{ user.email }}" class="uk-input"></div>
                    <div>{% trans %}Телефон{% endtrans %}: <input name="info[phone]" value="{{ phone }}" class="uk-input phone_validate"></div>
                    {#<div>Website: <input name="info[website]" value="{{ website }}" class="uk-input"></div>#}
                    {#<div>{% trans %}Кратко о себе/компании{% endtrans %}: <textarea name="info[about]" class="uk-textarea">{{ about }}</textarea></div>#}


                    <div class="uk-hidden">
                        <h2>{% trans %}Ссылки на соцсети{% endtrans %}</h2>

                        <div>Вконтакте: <input name="info[vk]" value="{{ vk }}" class="uk-input"></div>
                        <div>Facebook: <input name="info[fb]" value="{{ fb }}" class="uk-input"></div>
                        <div>Instagram: <input name="info[ig]" value="{{ ig }}" class="uk-input"></div>
                        <div>Одноклассники: <input name="info[ok]" value="{{ ok }}" class="uk-input"></div>
                        <div>Twitter: <input name="info[tw]" value="{{ tw }}" class="uk-input"></div>
                        <div>Google+: <input name="info[gp]" value="{{ gp }}" class="uk-input"></div>
                        <div>Youtube: <input name="info[yt]" value="{{ yt }}" class="uk-input"></div>
                    </div>
                    <input type="hidden" name="back_url" value="{{ user.tempPassword }}">
                    <button class="uk-button uk-button-primary uk-margin-top">{% trans %}Сохранить{% endtrans %}</button>
                </form>
            </div>
            <div class="uk-width-1-3@s {{ app.session.get('logged_user').whois == 'new_renter' ? 'uk-hidden' }}">
                <div class="uk-position-relative">
                    {% if foto != '' %}
                    <img src="/assets/images/users/t/{{ foto }}.jpg" alt="" style="height: 150px">
                        <button name="delete" form="profile_foto_upload" class="c_white bg_red uk-position-top-left"><i class="fa fa-close"></i></button>
                    {% endif %}

                </div>
                <form id="profile_foto_upload" action="/profile/saveFoto" method="POST" enctype="multipart/form-data">
                    {% trans %}Фото{% endtrans %}: <input id="foto_upload" type="file" name="foto">
                    <div id="foto_list_view" uk-grid class="uk-grid-small"></div>
                    <input type="hidden" name="user_id" value="{{ user.id }}">
                    <button class="uk-button uk-button-primary uk-margin-top">{% trans %}Сохранить{% endtrans %}</button>
                </form>
            </div>


        </div>
    </div>
{% endblock %}

